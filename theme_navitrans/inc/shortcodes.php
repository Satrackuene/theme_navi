<?php
/**
 * Shortcode para mostrar 5 iconos SVG con sus etiquetas.
 *
 * Este shortcode valida si la información de los iconos proviene de:
 * 1. Un campo ACF llamado 'iconos_seguridad' (array de booleanos) y 'labels_seguridad' (array de textos).
 * 2. Atributos del shortcode 'activos' (items separados por "|") y 'labels' (item:label separados por "|").
 * Si no se encuentra información, se asigna un label por defecto y una clase 'no-aplica'.
 */


function display_security_icons_shortcode($atts)
{

  // Definir atributos por defecto del shortcode
  $atts = shortcode_atts(
    array(
      'activos' => '', // Ejemplo: "abs|asis_frenado"
      'labels' => '', // Ejemplo: "abs:Tiene sistema ABS|asis_frenado:Asistente de frenado"
      'hide' => ''
    ),
    $atts,
    'iconos_seguridad'
  );

  $icons_data = array();

  // Iconos predefinidos y sus labels por defecto

  // abs  asis_estabilidad  colision  airbag  frenado_auto  bebes
  $default_icons = array(
    'abs' => array(
      'label' => 'Sistema antibloqueo de frenos.',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256,420.91h0c-44.05,0-85.46-17.16-116.61-48.3-31.15-31.15-48.3-72.56-48.3-116.61,0-44.05,17.16-85.46,48.3-116.61,31.15-31.15,72.56-48.3,116.61-48.3,0,0,0,0,.01,0,44.03.05,85.42,17.22,116.55,48.35s48.3,72.52,48.35,116.55c0,44.07-17.16,85.48-48.3,116.63-31.15,31.15-72.56,48.3-116.61,48.3ZM256.01,106.09c-40.04,0-77.69,15.59-106.01,43.91-28.32,28.31-43.91,65.96-43.91,106s15.59,77.69,43.91,106.01,65.96,43.91,106,43.91,77.69-15.59,106.01-43.91c28.32-28.31,43.91-65.96,43.91-106-.09-82.57-67.34-149.81-149.91-149.92h0Z"/><path d="M98.15,370.99c-2.4,0-4.75-1.15-6.2-3.27-22.51-32.99-34.41-71.62-34.41-111.72s11.9-78.73,34.41-111.71c2.33-3.42,7-4.3,10.42-1.97,3.42,2.34,4.3,7,1.97,10.42-20.8,30.48-31.8,66.18-31.8,103.25s10.99,72.78,31.8,103.27c2.33,3.42,1.45,8.09-1.97,10.42-1.29.88-2.77,1.31-4.22,1.31Z"/><path d="M413.87,370.99c-1.46,0-2.93-.42-4.22-1.31-3.42-2.33-4.3-7-1.97-10.42,20.8-30.47,31.79-66.18,31.79-103.25-.04-37.08-11.07-72.78-31.89-103.26-2.34-3.42-1.46-8.09,1.96-10.42,3.42-2.34,8.09-1.46,10.42,1.96,22.53,32.98,34.46,71.61,34.5,111.7,0,40.13-11.9,78.75-34.41,111.73-1.45,2.13-3.81,3.27-6.2,3.27Z"/><path d="M165.36,218.52l-28.69,76.38h24.08l3.72-12.6h26.77l3.82,12.6h24.7l-28.68-76.38h-25.73ZM169.59,265.74l8.35-27.45,8.43,27.45h-16.79Z"/><path d="M281.89,254.26c3.14-.96,5.98-2.72,8.23-5.1,2.8-3.21,4.31-7.35,4.21-11.61.1-5.16-2.06-10.1-5.91-13.54-4.74-3.92-10.81-5.88-16.95-5.47h-44.16v76.36h40.72c3.54-.17,7.07-.51,10.57-1.04,3.11-.27,6.15-1.12,8.95-2.5,3.14-1.79,5.74-4.37,7.55-7.5,1.87-3.24,2.82-6.93,2.76-10.68.16-4.36-1.21-8.64-3.88-12.1-3.16-3.56-7.42-5.96-12.1-6.82ZM251.12,234.03h10.41c2.65-.26,5.31.41,7.52,1.88,1.47,1.32,2.26,3.23,2.16,5.2.13,2.06-.66,4.08-2.16,5.5-2.27,1.5-4.98,2.17-7.68,1.9h-10.26v-14.48ZM271.73,276.34c-2.53,1.69-5.57,2.45-8.59,2.16h-12.02v-15.49h11.98c3.04-.29,6.09.43,8.67,2.06,1.63,1.33,2.54,3.34,2.47,5.44.09,2.22-.83,4.35-2.5,5.81v.03Z"/><path d="M372.31,258.73c-2.39-3.68-5.76-6.61-9.74-8.46-7.1-3.1-14.53-5.37-22.16-6.74-2.81-.34-5.52-1.3-7.92-2.81-1.04-.78-1.67-1.98-1.71-3.28,0-1.66.77-3.23,2.08-4.24,1.8-1.29,3.99-1.91,6.19-1.74,5.7-.65,10.85,3.44,11.5,9.14.03.23.05.47.06.7l22.23-1.3c-.38-6.82-3.72-13.14-9.14-17.3-6.71-4.05-14.49-5.95-22.31-5.44-6.39-.27-12.78.75-18.77,2.98-4.16,1.67-7.73,4.53-10.26,8.23-2.21,3.29-3.4,7.16-3.41,11.12-.13,5.67,2.32,11.09,6.67,14.74,6.54,4.79,14.13,7.97,22.13,9.27,4.3.59,8.42,2.1,12.08,4.43,1.61,1.3,2.57,3.24,2.61,5.31-.03,2.15-1.04,4.17-2.74,5.49-2.21,1.71-4.97,2.56-7.76,2.39-4.01.22-7.89-1.5-10.41-4.63-1.71-2.48-2.74-5.36-2.98-8.35l-22.44,1.41c.42,7.17,3.44,13.95,8.49,19.06,4.99,4.99,13.98,7.49,26.97,7.49,6.28.2,12.54-.89,18.38-3.2,4.62-1.94,8.57-5.21,11.34-9.4,2.67-4.01,4.09-8.72,4.06-13.54.05-3.98-1-7.89-3.04-11.3Z"/></svg>'
    ),
    'asis_estabilidad' => array(
      'label' => 'Control electrónico de tracción',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M336.03,453.04c-.2,0-.4-.01-.61-.04-10.5-1.31-28-5.41-43.42-11.61-19.05-7.66-28.7-16.02-28.7-24.86,0-18.13,31.68-21.52,59.62-24.51,17.56-1.88,46.94-5.03,46.94-14.12,0-6.47-14.57-15.15-47.13-19.96-2.65-.39-4.49-2.86-4.1-5.52s2.85-4.48,5.52-4.1c45.81,6.78,55.43,19.82,55.43,29.57,0,17.83-29.55,20.99-55.62,23.78-16.53,1.77-50.94,5.45-50.94,14.85,0,5.33,14.21,12.47,22.61,15.85,14.61,5.87,31.12,9.75,41,10.98,2.66.33,4.55,2.76,4.22,5.42-.31,2.46-2.4,4.26-4.82,4.26Z"/><path d="M182.52,453.04c-.2,0-.4-.01-.61-.04-10.5-1.31-28-5.41-43.42-11.61-19.05-7.66-28.7-16.02-28.7-24.86,0-18.13,31.68-21.52,59.62-24.51,17.56-1.88,46.94-5.03,46.94-14.12,0-6.47-14.57-15.15-47.13-19.96-2.65-.39-4.49-2.86-4.1-5.52.39-2.65,2.86-4.48,5.52-4.1,45.81,6.78,55.43,19.82,55.43,29.57,0,17.83-29.55,20.99-55.62,23.78-16.53,1.77-50.94,5.45-50.94,14.85,0,5.33,14.21,12.47,22.61,15.85,14.61,5.87,31.12,9.75,41,10.98,2.66.33,4.55,2.76,4.22,5.42-.31,2.46-2.4,4.26-4.82,4.26Z"/><path d="M235.04,282.81h-22.46c-2.68,0-4.86,2.17-4.86,4.86s2.17,4.86,4.86,4.86h22.46c2.68,0,4.86-2.17,4.86-4.86s-2.17-4.86-4.86-4.86Z"/><path d="M292.09,282.81h-22.47c-2.68,0-4.86,2.17-4.86,4.86s2.17,4.86,4.86,4.86h22.47c2.68,0,4.86-2.17,4.86-4.86s-2.17-4.86-4.86-4.86Z"/><path d="M361.92,169.2v-94.07c0-8.91-7.25-16.16-16.16-16.16h-186.85c-8.91,0-16.15,7.25-16.15,16.16v94.07c-6.34,1.28-11.13,6.9-11.13,13.61v26.83c0,6.72,4.79,12.33,11.13,13.62v43.24c-3.69,2.32-6.06,6.42-6.06,10.97v19.88c0,7.15,5.82,12.97,12.97,12.97h5.48v17.98c0,8.93,7.26,16.19,16.19,16.19h23.8c8.93,0,16.19-7.26,16.19-16.19v-17.98h82.04v17.98c0,8.93,7.26,16.19,16.18,16.19h23.82c8.92,0,16.18-7.26,16.18-16.19v-17.98h5.48c7.15,0,12.97-5.82,12.97-12.97v-19.88c0-4.55-2.37-8.65-6.05-10.97v-43.24c6.34-1.29,11.12-6.9,11.12-13.61v-26.83c0-6.71-4.78-12.32-11.12-13.61ZM358.26,297.35c0,1.79-1.46,3.25-3.25,3.25h-10.84c-.08,0-.16.01-.24.02-.11,0-.23,0-.34.02-.37-.02-.74-.04-1.12-.04h-180.25c-.39,0-.77.02-1.15.04-.12-.01-.23-.02-.35-.02-.07,0-.15-.02-.22-.02h-10.83c-1.79,0-3.25-1.46-3.25-3.25v-19.88c0-1.48,1-2.77,2.46-3.15.26-.07.52-.1.79-.1h205.35c.28,0,.55.03.84.11,1.42.37,2.41,1.66,2.41,3.14v19.88ZM323.59,197.21l-27.14,11.61h-88.22l-27.14-11.61v-57.09c0-3.29,2.68-5.97,5.97-5.97h130.55c3.29,0,5.97,2.68,5.97,5.97v57.09ZM332.1,223.67v40.83h-23.44v-28.01l12.82-12.82h10.62ZM298.33,238.35h-92c-1.34,0-2.43-1.09-2.43-2.43s1.09-2.43,2.43-2.43h92c1.34,0,2.43,1.09,2.43,2.43s-1.09,2.43-2.43,2.43ZM300.76,253.17c0,1.34-1.09,2.43-2.43,2.43h-92c-1.34,0-2.43-1.09-2.43-2.43s1.09-2.43,2.43-2.43h92c1.34,0,2.43,1.09,2.43,2.43ZM185.47,223.67l12.83,12.82v28.01h-23.44v-40.83h10.61ZM363.33,209.64c0,2.3-1.87,4.18-4.18,4.18h-13.24v50.68h-4.86v-131.86c0-11.68-9.5-21.17-21.17-21.17h-135.09c-11.68,0-21.17,9.5-21.17,21.17v131.86h-4.86v-50.68h-13.25c-2.3,0-4.17-1.87-4.17-4.18v-26.83c0-2.3,1.87-4.18,4.17-4.18h13.25v-46c0-14.35,11.68-26.03,26.03-26.03h135.09c14.35,0,26.03,11.68,26.03,26.03v46h13.24c2.3,0,4.18,1.87,4.18,4.18v26.83Z"/></svg>'
    ),
    'colision' => array(
      'label' => 'Alerta de colisión frontal',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M154.38,320.81H46.6c-2.76,0-5-2.24-5-5s2.24-5,5-5h107.78c5.52,0,10.01-4.49,10.01-10.01v-145.08c0-5.52-4.49-10.01-10.01-10.01H46.6c-2.76,0-5-2.24-5-5s2.24-5,5-5h107.78c11.03,0,20.01,8.98,20.01,20.01v145.08c0,11.03-8.98,20.01-20.01,20.01Z"/><path d="M257.34,187.97c-4.14,0-7.5-3.36-7.5-7.5,0-20.6,16.76-37.37,37.37-37.37,4.14,0,7.5,3.36,7.5,7.5s-3.36,7.5-7.5,7.5c-12.33,0-22.37,10.03-22.37,22.37,0,4.14-3.36,7.5-7.5,7.5Z"/><path d="M227.24,187.97c-4.14,0-7.5-3.36-7.5-7.5,0-37.2,30.27-67.47,67.47-67.47,4.14,0,7.5,3.36,7.5,7.5s-3.36,7.5-7.5,7.5c-28.93,0-52.47,23.54-52.47,52.47,0,4.14-3.36,7.5-7.5,7.5Z"/><path d="M197.14,187.97c-4.14,0-7.5-3.36-7.5-7.5,0-53.8,43.77-97.57,97.57-97.57,4.14,0,7.5,3.36,7.5,7.5s-3.36,7.5-7.5,7.5c-45.53,0-82.57,37.04-82.57,82.57,0,4.14-3.36,7.5-7.5,7.5Z"/><path d="M465.4,323.98h-83.86v-125.09c0-10.12-8.23-18.36-18.35-18.36h-68.01c-7.55,0-14.44,4.73-17.14,11.78l-23.39,61.02c-2,5.21-3.28,10.64-3.81,16.1-.21,1.99-.32,4.07-.32,6.2v97.23c0,2.76,2.24,5,5,5h25.95c-.19-1.64-.29-3.31-.29-5,0-24.24,19.65-43.89,43.89-43.89s43.89,19.65,43.89,43.89c0,1.69-.11,3.36-.29,5h7.85s.01,0,.02,0h88.86c2.76,0,5-2.24,5-5v-43.89c0-2.76-2.24-5-5-5ZM277.36,322.02c0,3.85-3.11,6.96-6.96,6.96h-14.56c-.1,0-.21,0-.31-.01v-35.61c.1-.01,14.87-.01,14.87-.01,3.85,0,6.96,3.11,6.96,6.96v21.7ZM343.82,240.47l-29.5,29.5h-56.98s0-5.61,4.96-18.45c2.91-7.51,17.14-43.78,17.14-43.78h64.37v32.73Z"/><path d="M465.4,135.72h-59.63c-11.03,0-20,8.98-20,20.01v145.08c0,11.03,8.97,20,20,20h59.63c2.76,0,5-2.24,5-5v-175.09c0-2.76-2.24-5-5-5Z"/><path d="M325.08,335c-20.91,0-37.87,16.95-37.87,37.87s16.95,37.87,37.87,37.87,37.87-16.95,37.87-37.87-16.95-37.87-37.87-37.87ZM325.08,390.39c-9.67,0-17.51-7.84-17.51-17.51s7.84-17.51,17.51-17.51,17.51,7.84,17.51,17.51-7.84,17.51-17.51,17.51Z"/><path d="M158.99,323.98H46.85c-1.33,0-2.6.53-3.54,1.47-.94.94-1.46,2.21-1.46,3.54l.07,34.56c4.27-19.76,21.85-34.58,42.89-34.58,24.24,0,43.89,19.65,43.89,43.89,0,1.69-.11,3.36-.29,5h30.58c9.43,0,17.1-7.66,17.1-17.08v-19.71c0-9.43-7.67-17.09-17.1-17.09Z"/><path d="M84.81,335c-20.91,0-37.87,16.95-37.87,37.87s16.95,37.87,37.87,37.87,37.87-16.95,37.87-37.87-16.95-37.87-37.87-37.87ZM84.81,390.39c-9.67,0-17.51-7.84-17.51-17.51s7.84-17.51,17.51-17.51,17.51,7.84,17.51,17.51-7.84,17.51-17.51,17.51Z"/></svg>'
    ),
    'airbag' => array(
      'label' => 'Sistema de bolsa de aire o airbag',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 512 512"><path d="M329.02,100.83c19.374,0,35.08,15.706,35.08,35.08s-15.706,35.08-35.08,35.08-35.08-15.706-35.08-35.08,15.706-35.08,35.08-35.08ZM188.95,102.71c40.957,0,74.16,33.203,74.16,74.16s-33.203,74.16-74.16,74.16-74.16-33.203-74.16-74.16,33.203-74.16,74.16-74.16ZM314.779,404.769c-5.862,0-11.6-2.928-14.93-8.255l-69.117-110.611c-5.133-8.217-2.628-19.076,5.585-24.209,8.216-5.132,19.073-2.621,24.207,5.592l69.117,110.611c2.487,3.98,3.276,8.69,2.222,13.263-1.056,4.572-3.828,8.46-7.807,10.946-2.887,1.804-6.101,2.663-9.277,2.663ZM245.603,264.028c-2.272,0-4.571.615-6.636,1.905-5.875,3.672-7.667,11.44-3.995,17.319l69.117,110.61c3.674,5.876,11.439,7.673,17.317,4.002,2.846-1.778,4.829-4.56,5.584-7.83.754-3.271.189-6.641-1.59-9.488l-69.117-110.611c-2.382-3.812-6.487-5.907-10.681-5.907ZM218.75,283.05c-18.54-4.13-41.4-5.88-51.36-4.25-13.94,2.27-44.73,58.85-63.56,97.93-18.83,39.08,7.77,43.08,29.66,21.19,21.89-21.89,43.79-68.27,43.79-68.27,0,0,39.08,5.18,58.03,8.94,5.26,1.04,11.41,1.77,17.99,1.71l-34.55-57.24v-.01ZM300.29,314.32c1.53-1.68,3.03-3.45,4.48-5.38,21.19-28.25,51.79-84.28,41.9-109.23-9.89-24.95-28.01-12.95-45.2,4.24-10.04,10.04-25.87,34.07-37.29,52.31l36.11,58.07v-.01ZM357.816,218.168l.104-6.181c.1-5.893-.713-11.061-2.414-15.358-2.284-5.758-5.188-10.32-8.629-13.56l-1.877-1.766,43.652-43.652c5.564-5.555,13.955-6.602,20.578-3.139v-1.146l4.27,4.276c6.843,6.854,6.842,18-.002,24.844l-55.682,55.681ZM352.104,181.271c3.188,3.534,5.89,8.069,8.051,13.517,1.342,3.39,2.2,7.209,2.568,11.404l47.24-47.239c4.803-4.804,4.894-12.568.273-17.492l-.273-.272c-4.896-4.896-12.872-4.896-17.776,0l-40.083,40.083Z"/>
</svg>'
    ),
    'frenado_auto' => array(
      'label' => 'Frenado autónomo de emergencia',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><circle cx="256" cy="201.48" r="17.11"/><path d="M256,176.66h0c-5.77,0-10.65-4.27-11.42-9.98l-10.31-76.36c-1.78-13.16,8.46-24.87,21.73-24.87h0c13.28,0,23.51,11.71,21.73,24.87l-10.31,76.36c-.77,5.72-5.65,9.98-11.42,9.98Z"/><path d="M342.25,349.6c-18.63,0-33.73,15.1-33.73,33.73s15.1,33.73,33.73,33.73,33.73-15.1,33.73-33.73-15.1-33.73-33.73-33.73ZM342.25,398.94c-8.62,0-15.6-6.99-15.6-15.6s6.99-15.6,15.6-15.6,15.6,6.99,15.6,15.6-6.99,15.6-15.6,15.6Z"/><path d="M169.75,349.6c18.63,0,33.73,15.1,33.73,33.73s-15.1,33.73-33.73,33.73-33.73-15.1-33.73-33.73,15.1-33.73,33.73-33.73ZM169.75,398.94c8.62,0,15.6-6.99,15.6-15.6s-6.99-15.6-15.6-15.6-15.6,6.99-15.6,15.6,6.99,15.6,15.6,15.6Z"/><path d="M89.05,187.44c3.56,0,6.44,2.88,6.44,6.44v77.65c0,3.56-2.88,6.44-6.44,6.44h-48.76v54.53c0,2.46,1.99,4.45,4.45,4.45h53.12c9.82,0,17.82-7.99,17.82-17.82v-129.24c0-9.83-7.99-17.83-17.82-17.83h-53.12c-2.46,0-4.45,1.99-4.45,4.45v10.9h48.76Z"/><path d="M422.95,277.97c-3.56,0-6.44-2.88-6.44-6.44v-77.65c0-3.56,2.88-6.44,6.44-6.44h48.76v-10.9c0-2.46-1.99-4.45-4.45-4.45h-53.12c-9.82,0-17.82,8-17.82,17.83v129.24c0,9.82,7.99,17.82,17.82,17.82h53.12c2.46,0,4.45-1.99,4.45-4.45v-54.53h-48.76Z"/><path d="M467.25,339.78h-74.7v-111.43c0-9.02-7.33-16.35-16.34-16.35h-60.58c-6.73,0-12.87,4.22-15.27,10.49l-20.83,54.36c-1.78,4.64-2.92,9.48-3.39,14.34-.19,1.77-.28,3.63-.28,5.52v86.62c0,2.46,1.99,4.45,4.45,4.45h23.12c-.17-1.46-.26-2.95-.26-4.45,0-21.59,17.5-39.09,39.09-39.09s39.09,17.5,39.09,39.09c0,1.51-.09,2.99-.26,4.45h6.99s.01,0,.02,0h79.16c2.46,0,4.45-1.99,4.45-4.45v-39.1c0-2.46-1.99-4.45-4.45-4.45ZM299.75,338.04c0,3.43-2.77,6.2-6.2,6.2h-12.97c-.09,0-.19,0-.28,0v-31.72c.09,0,13.25,0,13.25,0,3.43,0,6.2,2.77,6.2,6.2v19.33ZM358.94,265.39l-26.28,26.28h-50.76s0-5,4.42-16.43c2.59-6.69,15.27-39,15.27-39h57.35v29.15Z"/><path d="M232.49,276.85l-20.83-54.36c-2.41-6.28-8.54-10.49-15.27-10.49h-60.58c-9.01,0-16.34,7.34-16.34,16.35v111.43H44.75c-2.46,0-4.45,1.99-4.45,4.45v39.1c0,2.46,1.99,4.45,4.45,4.45h79.16s.01,0,.02,0h6.99c-.17-1.46-.26-2.95-.26-4.45,0-21.59,17.5-39.09,39.09-39.09s39.09,17.5,39.09,39.09c0,1.51-.09,2.99-.26,4.45h23.12c2.46,0,4.45-1.99,4.45-4.45v-86.62c0-1.89-.1-3.75-.28-5.52-.47-4.87-1.61-9.7-3.39-14.34ZM179.33,291.67l-26.28-26.28v-29.15h57.35s12.68,32.3,15.27,39c4.42,11.43,4.42,16.43,4.42,16.43h-50.76ZM231.71,344.23c-.09,0-.19,0-.28,0h-12.97c-3.43,0-6.2-2.77-6.2-6.2v-19.33c0-3.43,2.77-6.2,6.2-6.2,0,0,13.16,0,13.25,0v31.72Z"/></svg>'
    ),
    'bebes' => array(
      'label' => 'ISOFIX<br>Sistema de sujeción infantil',
      'icon' => '<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M345.61,338.47h-57.68c-16.52,0-20.73-12.62-22.72-23.07,0,0,0-.01,0-.02-2.11-24.43-22.6-43.61-47.58-43.61-.76,0-1.52.04-2.27.07-.08,0-.15-.01-.23,0-.16,0-.31.02-.47.03-.15,0-.3.02-.46.03-10.74.72-20.79,3.64-20.79,3.64l-.06.02-28.31-84.05c9.75-8.32,15.94-20.69,15.94-34.51,0-25.05-20.31-45.36-45.36-45.36s-45.36,20.31-45.36,45.36c0,7.3,1.73,14.19,4.8,20.3.16.58.29,1.15.49,1.73,0,0,56.06,167.62,62.68,186.07,6.62,18.45,23.76,35.15,45.6,35.26h141.8c17.09,0,30.94-13.85,30.94-30.94h0c0-17.09-13.85-30.94-30.94-30.94Z"/><path d="M176.64,193.98c8.55,16.09,25.47,27.04,44.95,27.04,28.1,0,50.88-22.78,50.88-50.88s-22.78-50.88-50.88-50.88c-13.95,0-26.59,5.62-35.78,14.71,3.23,7.01,5.05,14.81,5.05,23.03,0,13.76-5.12,26.88-14.22,36.97Z"/><path d="M419.87,288.21c-4.68-11.03-17.28-16.4-28.76-12.96l-74.36,22.3c-6.04,1.81-12.56.16-17.06-4.25-4.67-4.58-9.14-9.68-13.16-14.67-4.32-5.36-1.92-13.38,4.61-15.54l34.67-11.45c9.47-3.13,17.22-13.85,17.22-23.82h0c0-16.52-12.96-26.19-28.8-21.49l-121.61,36.12,7.22,21.44c3.91-.76,8.72-1.52,13.69-1.85l1.31-.09h.48c.76-.04,1.52-.07,2.29-.07,29.46,0,54.55,22.83,57.37,52.08,2.42,12.34,6.27,14.62,12.93,14.62h57.68c6.75,0,13.12,1.68,18.73,4.59l41.42-13.68c12.84-4.24,19.51-18.58,14.12-31.29Z"/></svg>'
    ),
  );

  // 1. Intentar obtener los datos de ACF
  if (function_exists('get_field')) {
    $acf_activos = get_field('iconos_seguridad');
    $acf_labels = get_field('labels_seguridad');

    if (is_array($acf_activos) && !empty($acf_activos)) {
      foreach ($default_icons as $key => $default_label) {
        $is_active = isset($acf_activos[$key]) ? (bool) $acf_activos[$key] : false;
        $label = isset($acf_labels[$key]) && !empty($acf_labels[$key]) ? $acf_labels[$key] : $default_label;
        $icons_data[$key] = array(
          'active' => $is_active,
          'label' => $label,
        );
      }
    }
  }

  // 2. Sobrescribir con datos de los atributos del shortcode si existen
  if (empty($icons_data) && !empty($atts['activos'])) {
    $active_items_from_atts = explode('|', $atts['activos']);
    foreach ($active_items_from_atts as $item) {
      $item = sanitize_title($item);
      if (isset($default_icons[$item])) {
        if (!isset($icons_data[$item])) {
          $icons_data[$item] = array();
        }
        $icons_data[$item]['active'] = true;
      }
    }
  }

  // 3. Sobrescribir con datos de los atributos del shortcode si existen
  if (isset($atts['hide']) && !empty($atts['hide'])) {
    $hide_items_from_atts = explode('|', $atts['hide']);

    foreach ($hide_items_from_atts as $item) {
      $item = sanitize_title($item);
      if (isset($default_icons[$item])) {
        if (!isset($icons_data[$item])) {
          $icons_data[$item] = array();
        }
        $icons_data[$item]['hide'] = true;
      }
    }
  }

  if (empty($icons_data) && !empty($atts['labels'])) {
    $labels_from_atts = explode('|', $atts['labels']);
    foreach ($labels_from_atts as $label_pair) {
      $parts = explode(':', $label_pair, 2);
      if (count($parts) === 2) {
        $item_key = sanitize_title($parts[0]);
        $item_label = wp_kses_post($parts[1]);
        if (isset($default_icons[$item_key])) {
          if (!isset($icons_data[$item_key])) {
            $icons_data[$item_key] = array();
          }
          $icons_data[$item_key]['label'] = $item_label;
        }
      }
    }
  }

  $output = '<div class="security-icons-container">';
  foreach ($default_icons as $key => $item) {
    if (!isset($icons_data[$key]['hide']) || !$icons_data[$key]['hide']) {
      $label = $icons_data[$key]['label'] ?? $item['label'];

      $clase = (isset($icons_data[$key]['active']) && $icons_data[$key]['active']) ? 'aplica' : 'no-aplica';

      $output .= '<div class="security-icon-item ' . esc_attr($clase) . '">';
      $output .= '<div class="security-icon-svg">' . $item['icon'] . '</div>';
      $output .= '<span class="security-icon-label">' . $label . '</span>';
      $output .= '</div>';
    }

  }

  $output .= '</div>';

  return $output;
}
add_shortcode('iconos_seguridad', 'display_security_icons_shortcode');

/**
 * Encola los estilos CSS para los iconos de seguridad solo si el shortcode está presente.
 */
function security_icons_enqueue_styles()
{
  // Asegúrate de que estamos en una página o post individual
  if (is_singular()) {
    global $post; // Accede al objeto global $post para obtener el contenido
    $content = $post->post_content; // Obtiene el contenido de la publicación actual

    // Reemplaza 'tu_shortcode_aqui' con el nombre de tu shortcode (sin corchetes)
    if (has_shortcode($content, 'iconos_seguridad')) {
      // Encola tu hoja de estilos
      wp_enqueue_style(
        'mi-estilo-shortcode-foxl', // Un identificador único para tu hoja de estilos
        get_template_directory_uri() . '/assets/css/security-icons.css', // Ruta a tu archivo CSS
        array(), // Dependencias (otros estilos que deben cargarse antes), deja vacío si no hay
        _S_VERSION, // Número de versión para cache-busting
        'all' // Media query (ej. 'screen', 'print', 'all')
      );
    }
  }
}
// Engancha la función a 'wp_enqueue_scripts' para que se ejecute después de que se determine el contenido
add_action('wp_enqueue_scripts', 'security_icons_enqueue_styles');